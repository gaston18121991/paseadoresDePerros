<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="styles.css" type="text/css">
    <title>Paseadores de Mascotas</title>
</head>
<body>
    <div id="cinta-blanca-transparente">
        <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#inicioModal">Iniciar</button>
        <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#registroModal">Registrar</button>
    </div>
    <!-- Modal de Registro -->
    <div class="modal fade" id="registroModal" tabindex="-1" aria-labelledby="registroModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registroModalLabel">Formulario de Registro</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Contenido del modal de registro -->
                    <form>
                        <h3>Datos Personales</h3>
                        <div class="mb-3">
                            <label for="camera">Tomar Foto 4x4:</label>
                            <video id="camera" width="240" height="240" autoplay></video>
                            <button onclick="capturarFoto(event)">Tomar Foto</button>
                            <canvas id="fotoCanvas" style="display: none"></canvas>
                            <img id="previewFoto" src="#" alt="Vista previa de la foto" style="display: none;">
                        </div>
                        <input type="file" id="fotoInput" name="foto" style="display: none">
                        <label for="fotoInput" id="seleccionarFotoLabel">Seleccionar Foto</label>
                        <div class="mb-3">
                            <label for="nombre" class="form-label">Nombre</label>
                            <input type="text" name="nombre" class="form-control" id="nombre" placeholder="Ingrese su nombre">
                        </div>
                        <div class="mb-3">
                            <label for="apellido" class="form-label">Apellido</label>
                            <input type="text" name="apellido" class="form-control" id="apellido" placeholder="Ingrese su apellido">
                        </div>
                        <div class="mb-3">
                            <label for="documento" class="form-label">Número de Documento</label>
                            <input type="text" name="DNI" class="form-control" id="documento" style="max-width: 25%; min-width: 20%">
                        </div>
                        <div class="mb-3">
                            <label for="nacionalidad" class="form-label">Nacionalidad</label>
                            <select class="form-select" id="nacionalidad" name="nacionalidad">
                                <optgroup label="América">
                                <option value="Argentina">Argentina</option>
                                <option value="Brasil">Brasil</option>
                                <option value="Colombia">Colombia</option>
                                <option value="Chile">Chile</option>
                                <option value="Ecuador">Ecuador</option>
                                <option value="Estados Unidos">Estados Unidos</option>
                                <option value="México">México</option>
                                <option value="Paraguay">Paraguay</option>
                                <option value="República Dominicana">República Dominicana</option>
                                <option value="Uruguay">Uruguay</option>
                                <option value="Venezuela">Venezuela</option>
                                </optgroup>
                                <optgroup label="Asia">
                                    <option value="China">China</option>
                                    <option value="Japón">Japón</option>
                                    <option value="Korea del Norte">Korea del Norte</option>
                                    <option value="Korea del Sur">Korea del Sur</option>
                                    <option value="Qatar">Qatar</option>
                                    <option value="Rusia">Rusia</option>
                                </optgroup>
                                <optgroup label="Europa">
                                <option value="España">España</option>
                                <option value="Francia">Francia</option>
                                <option value="Inglaterra">Inglaterra</option>
                                <option value="Italia">Italia</option>
                                <option value="Países Bajos">Países Bajos</option>
                                <option value="Portugal">Portugal</option>
                                <option value="Ucrania">Ucrania</option>
                                </optgroup>
                            </select>
                        </div>
        <h3>Domicilio</h3>
        <div class="mb-3">
            <label for="calle" class="form-label">Calle</label>
            <input type="text" name="calle" class="form-control" id="calle" placeholder="Ingrese el nombre de la calle" style="max-width: 50%; min-width: 30%">
        </div>
        <div class="mb-3">
            <label for="numero" class="form-label">Número</label>
            <input type="text" name="numeroCalle" class="form-control" id="numero" placeholder="Ingrese el número">
        </div>
        <div class="mb-3">
            <label for="tipo-vivienda" class="form-label">Tipo de Vivienda</label>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="tipoVivienda" id="casa" value="casa">
                <label class="form-check-label" for="casa">Casa</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="tipoVivienda" id="edificio" value="edificio">
                <label class="form-check-label" for="edificio">Edificio</label>
            </div>
        </div>
        <div id="campoCasa" style="display: none;">
            <div class="mb-3">
                <label for="numeroCasa" class="form-label">Número de Casa</label>
                <input type="text" name="numeroCasa" class="form-control" id="numeroCasa" placeholder="Ingrese el número de casa">
            </div>
            <div class="mb-3">
                <label for="localidad" class="form-label">Localidad</label>
                <input type="text" name="localidad" class="form-control" id="localidad" placeholder="Ingrese la localidad">
            </div>
            <div class="mb-3">
                <label for="barrio" class="form-label">Barrio</label>
                <input type="text" name="barrio" class="form-control" id="barrio" placeholder="Ingrese el barrio">
            </div>
            <div class="mb-3">
                <label for="provincia" class="form-label">Provincia</label>
                <input type="text" name="provincia" class="form-control" id="provincia" placeholder="Ingrese la provincia">
            </div>
            <div class="form-group">
                <h3>Función en el registro</h3>
                <label for="tipo_usuario">Tipo de Usuario:</label>
                <select class="form-control" id="tipo_usuario">
                    <option value="">Seleccionar</option>
                    <option value="cliente">Cliente</option>
                    <option value="paseador">Paseador</option>
                </select>
            </div>
        </div>
        <div id="campoEdificio" style="display: none;">
            <div class="mb-3">
                <label for="piso" class="form-label">Piso</label>
                <input type="text" name="piso" class="form-control" id="piso" placeholder="Ingrese el piso">
            </div>
            <div class="mb-3">
                <label for="depto" class="form-label">Depto</label>
                <input type="text" name="depto" class="form-control" id="depto" placeholder="Ingrese el departamento">
            </div>
            <div class="mb-3">
                <label for="localidad" class="form-label">Localidad</label>
                <input type="text" name="localidad" class="form-control" id="localidad" placeholder="Ingrese la localidad">
            </div>
            <div class="mb-3">
                <label for="barrio" class="form-label">Barrio</label>
                <input type="text" name="barrio" class="form-control" id="barrio" placeholder="Ingrese el barrio">
            </div>
            <div class="mb-3">
                <label for="provincia" class="form-label">Provincia</label>
                <input type="text" name="provincia" class="form-control" id="provincia" placeholder="Ingrese la provincia">
            </div>
            <div class="form-group">
                <h3>Función en el registro</h3>
                <label for="tipo_usuario">Tipo de Usuario:</label>
                <select class="form-control" id="tipo_usuario">
                    <option value="">Seleccionar</option>
                    <option value="cliente">Cliente</option>
                    <option value="paseador">Paseador</option>
                </select>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Registrarse</button>
    </form>
</div>

<script>
    const video = document.getElementById('camera');
    const canvas = document.getElementById('fotoCanvas');
    const preview = document.getElementById('previewFoto');
    
    navigator.mediaDevices.getUserMedia({ video: true })
    .then(function(stream) {
        video.srcObject = stream;
    })
    .catch(function(error) {
        console.log('Error al acceder a la cámara: ' + error);
    });

    function capturarFoto(event) {
        event.preventDefault(); // Detener la acción predeterminada del botón para evitar que se cierre el modal
    
        var canvas = document.getElementById('fotoCanvas');
        var video = document.getElementById('camera');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
        var fotoURL = canvas.toDataURL('image/png');
        var ctx = canvas.getContext('2d');

        // Dibujar un fondo blanco en el canvas
        ctx.fillStyle = '#FFFFFF'; // Color blanco
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    
        // Convertir la imagen en un Blob
        var byteCharacters = atob(fotoURL.split(',')[1]);
        var byteNumbers = new Array(byteCharacters.length);
        for (var i = 0; i < byteCharacters.length; i++) {
            byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        var byteArray = new Uint8Array(byteNumbers);
        var blob = new Blob([byteArray], { type: 'image/png' });
    
        // Crear un archivo a partir del Blob
        var file = new File([blob], 'foto_4x4.png', { type: 'image/png' });
    
        // Asignar el archivo al campo de entrada de tipo file
        var input = document.getElementById('fotoInput');
        var fileInput = new DataTransfer();
        fileInput.items.add(new File([blob], 'foto_4x4.png', { type: 'image/png' }));
        input.files = fileInput.files;
    
        // Mostrar la imagen seleccionada
        var seleccionarFotoLabel = document.getElementById('seleccionarFotoLabel');
        seleccionarFotoLabel.textContent = 'Foto seleccionada: foto_4x4.png';

        // Abrir una nueva ventana y mostrar la imagen capturada
    var nuevaVentana = window.open('', '_blank');
    nuevaVentana.document.write('<img src="' + fotoURL + '" alt="Foto con fondo blanco">');
    }

        /*____________Hasta aquí la función*/

    const documentoInput = document.getElementById('documento');

    documentoInput.addEventListener('input', function() {
        let inputValue = this.value.replace(/\D/g, '');
        let formattedValue = inputValue.replace(/(\d{2})(\d{3})(\d{3})/, '$1.$2.$3');
        this.value = formattedValue.substring(0, 10);
    });


    const casaRadio = document.getElementById('casa');
    const edificioRadio = document.getElementById('edificio');
    const campoCasa = document.getElementById('campoCasa');
    const campoEdificio = document.getElementById('campoEdificio');

    casaRadio.addEventListener('change', function() {
        if (casaRadio.checked) {
            campoCasa.style.display = 'block';
            campoEdificio.style.display = 'none';
        }
    });

    edificioRadio.addEventListener('change', function() {
        if (edificioRadio.checked) {
            campoEdificio.style.display = 'block';
            campoCasa.style.display = 'none';
        }
    });
</script>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal de Inicio -->
    <div class="modal fade" id="inicioModal" tabindex="-1" aria-labelledby="inicioModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="inicioModalLabel">Inicio de Sesión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Contenido del modal de inicio de sesión -->
                    <form action="">
                        <div class="mb-3">
                            <label for="email" class="form-label">Correo Electrónico</label>
                            <input type="email" class="form-control" id="email" placeholder="Ingrese su correo electrónico">
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="password" placeholder="Ingrese su contraseña">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary">Iniciar Sesión</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>